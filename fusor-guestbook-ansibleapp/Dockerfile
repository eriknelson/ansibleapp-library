FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjCiMgTk9URTogVGhpcyBpcyBhIHByb3RvdHlwZSBiaW5kaW5nIGNvbnN1bWVyIGFuZCB3aWxs\
IGxpa2VseQojIGNoYW5nZSBmcmVxdWVudGx5IGFzIHRoZSBmb3JtYXQgaXMgaXRlcmF0ZWQgdXBv\
bgojIER5bmFtaWNhbGx5IGNvbnN1bWVzIEhPU1QvUE9SVCBmcm9tIGVudmlyb25tZW50IGJhc2Vk\
IG9uIGJpbmRpbmcKIyBrZXkuIEV4OiBiaW5kaW5nX2tleT1FWFRFUk5BTF9NTEFCLCBndWVzdGJv\
b2sgd2lsbCBsb29rIGZvcgojIEVYVEVSTkFMX01MQUJfU0VSVklDRV97SE9TVCxQT1JUfSBhcyBh\
cmUgcHJvdmlkZWQgYnkgdGhlIHNlcnZpY2UvZW5kcG9pbnQKIyBhc3NldHMgdGhhdCB3ZXJlIGNy\
ZWF0ZWQgYnkgYW4gZXh0ZXJuYWwtbWxhYi1hbnNpYmxlYXBwIHByb3Zpc2lvbi4KIwojIFNlY3Jl\
dHMgYXJlIG5vdCBhdmFpbGFibGUgeWV0LCBidXQgd2hlbiB0aGV5IGFyZSwgdGhleSB3aWxsCiMg\
YWxzbyBiZSBwcm92aWRlZCBieSBhIHBvZCBpbmplY3Rpb24gcG9saWN5LiBVbnRpbCBhIHJlYWwK\
IyBjYXRhbG9nIGNhbiBwcm92aWRlIHRoaXMgc2VydmljZSwgd2UnbGwgZmFrZSBpdCBhbmQgYWxs\
b3cgdGhlCiMgYXNiY2xpIHRvIHByb3ZpZGUgdGhlc2UgcGFyYW1ldGVycy4KIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmlkOiAzNWVh\
ZDRlOC1jZjFmLTQ5MDktYmIxYi1iOTgxZjRlYjMxNDIKbmFtZTogZnVzb3ItZ3Vlc3Rib29rLWFu\
c2libGVhcHAKaW1hZ2U6IGVyaWtuZWxzb24vZnVzb3ItZ3Vlc3Rib29rLWFuc2libGVhcHAKZGVz\
Y3JpcHRpb246IEEgbW9uZ28gYmFja2VkIGd1ZXN0Ym9vayBpbiBub2RlCmJpbmRhYmxlOiBmYWxz\
ZQphc3luYzogInVuc3VwcG9ydGVkIgpwYXJhbWV0ZXJzOgogIC0gbmFtZTogYmluZGluZ19rZXkK\
ICAgIGRlc2NyaXB0aW9uOiBrZXkgdG8gcmVzb2x2ZSBiaW5kIHByb3BlcnRpZXMKICAtIG5hbWU6\
IG1vbmdvX3VzZXIKICAgIGRlc2NyaXB0aW9uOiBNb25nb0RCIFVzZXIKICAgIHR5cGU6IHN0cmlu\
ZwogIC0gbmFtZTogbW9uZ29fcGFzcwogICAgZGVzY3JpcHRpb246IE1vbmdvREIgUGFzc3dvcmQK\
ICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogbW9uZ29fZGIKICAgIGRlc2NyaXB0aW9uOiBNb25n\
b0RCIERhdGFiYXNlCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IHByb2plY3RfbmFtZQogICAg\
ZGVzY3JpcHRpb246IE9wZW5zaGlmdCBwcm9qZWN0CiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1\
bHQ6IGZ1c29yLWd1ZXN0Ym9vay1hbnNpYmxlYXBwCg=="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
